# CodeAI Hub

CodeAI Hub is a Visual Studio Code extension that unifies multiple AI providers behind a single, type-safe experience. The project enforces strict quality and architecture rules through Ultracite, keeping the codebase ready for multi-agent orchestration.

## Current Release — v1.1.6
- **Autonomous core bootstrap**: the extension now downloads, verifies, and launches `codeai-hub-core` the moment the view opens. Installers read `assets/core/manifest.json`/`assets/launcher/manifest.json` and fall back across mirrors to avoid 404s.
- **Dual-client sync**: both the VS Code webview and the standalone CEF client connect to the same local core (HTTP `:8080`, WS `/api/v1/stream`). New sessions and messages broadcast instantly across clients.
- **Security + CSP fixes**: the webview explicitly allows `http://127.0.0.1` HTTP/WS connections, so the UI can reach the local core without workarounds.
- **Release artifacts**: `codeai-hub-1.1.6.vsix` ships alongside `CodeAIHubLauncher-macos-arm64-1.0.43.tar.bz2` and `codeai-hub-core-darwin-arm64-0.1.0.tar.bz2`. CEF continues to stream from Spotify’s CDN.
- **Known limitation**: deleting a session in one client does not yet propagate to the other. The issue is tracked for the next session (broadcast pipeline work).

## Features
- **React-driven command bar**: the extension view opens with a React-rendered quick-action row that mirrors the Claude Code Fusion UX.
- **Type-safe extension host**: webview messages are routed through facades and hooks with zero usage of `any`.
- **Quality gates out of the box**: architecture checks, duplication scanning, Ultracite linting, and TypeScript compilation run on every commit.
- **Scripted releases**: a single `scripts/build-release.sh` command bumps the version, builds the shell, validates the codebase, and packages a VSIX.

## Getting Started
```bash
git clone https://github.com/OleynikAleksandr/CodeAI-Hub.git
cd CodeAI-Hub
npm install
```

## Development Workflow
1. **Create or modify code** under `src/`. Keep files below 300 lines and prefer micro-classes plus facades.
2. **Run quality checks** before committing:
   ```bash
   npm run quality        # architecture check + Ultracite lint
   npm run check:tsprune  # optional: detect unused exports
   npm run compile        # ensure TypeScript output builds
   ```
3. **Commit**; pre-commit hooks re-run the same gates automatically.

## Building a Release
Always use the provided script to create a VSIX:
```bash
./scripts/build-release.sh <version>
```
The script performs:
- cache cleanup and version bump in `package.json`;
- optional webview UI build (if a bundled React app exists);
- architecture, duplication, lint, and type checks;
- VSIX packaging via `vsce`.

Artifacts such as `.claude`, `.vscode`, `doc/**`, and other local assets are excluded through `.vscodeignore`. After the script finishes, upload **three** assets to the GitHub Release whose tag matches the version: the VSIX, the launcher tarball, and the core tarball. (CEF is still downloaded from the public CDN.)

### Verifying the core runtime
```bash
# Ensure the orchestrator is running
curl http://127.0.0.1:8080/api/v1/health

# Optional: inspect active sessions / providers
curl http://127.0.0.1:8080/api/v1/status | jq .
```

## Repository Layout
```
media/                       Bundled webview assets (CSS + JS) shipped with the extension.
media/react-chat.js          React bundle generated by the webview build script.
media/web-client/            Standalone web client shell (HTML + bundled app.js + macOS launcher assets).
src/core/webview-module/     HTML scaffold that injects the webview assets.
src/extension-module/        Extension host micro-classes.
src/extension.ts             Entry point registering the webview provider.
src/client/ui/src/app-host/ Hooks that coordinate the session host and provider picker.
src/client/ui/src/components/action-bar/ React implementation of the quick-action bar.
src/client/ui/src/components/settings/ Modular settings UI with reusable parts.
scripts/                     Quality and release automation.
doc/                         Architecture and knowledge base (ignored in VSIX).
```

## License
License information will be added in a future update. Until then, treat the repository as proprietary and request permission before redistribution.
