# Settings Panel Migration

## Назначение
- Воспроизвести окно настроек из claude-code-fusion без изменений, обеспечив совместимость с текущим webview-потоком.
- Поддерживать события `settings:load`, `settings:save`, `settings:reset`, `settings:closed` для обмена между вебвью и расширением.
- Сохранить thinking-настройки (enabled/maxTokens) и предоставить заглушки до подключения реального фасада конфигураций.

## Структура
- **settings-view.tsx** — React-компонент, рендерящий модальное окно с шапкой, основным контентом, блоком Thinkings Settings и футером действий.
- **settings/thinking-settings.tsx** — вложенный компонент с чекбоксом и числовым полем, повторяющий оригинальную вёрстку и ограничения (2000–32000 токенов, шаг 1000).
- **app-host.tsx** — контейнер, показывающий модалку поверх сессионного UI и транслирующий `settings:closed`.
- **SettingsMessageHandler.ts** — обработчик сообщений расширения (заглушки загрузки/сохранения, ответ на reset и закрытие).

## Поток сообщений
1. Пользователь нажимает иконку шестиренки → `HomeViewProvider` отправляет `ui:showSettings` в вебвью.
2. `AppHost` открывает модалку `SettingsView`, которая сразу отправляет `settings:load`.
3. `SettingsMessageHandler` отвечает `settings:loaded` с текущими значениями (пока в памяти).
4. При изменении чекбокса/значения токенов активируется кнопка `Save Changes`.
5. Нажатие `Save` → `settings:save` → `SettingsMessageHandler` обновляет заглушки и шлёт `settings:saved`.
6. Нажатие `Reset to Defaults` → `settings:reset` → загрузка дефолтных значений.
7. Закрытие модалки кнопками `×`/`Close` → отправка `settings:closed` в расширение.

## Заглушечное хранение
- Значения сохраняются в `SettingsMessageHandler` (внутрипроцессный стейт) до появления реального фасада конфигураций.
- Пределы (2000/32000 токенов) и предупреждения о Thinking Mode сохранены без изменений из оригинального проекта.

## Известные ограничения
- Нет связки с persistent storage VS Code (значения сбрасываются при перезапуске).
- Логи из исходного компонента удалены ради соответствия lint-правилам (`noConsole`).
- Архитектурный чек предупреждает, что `settings-view.tsx` и `thinking-settings.tsx` близки к лимиту 300 строк; при следующих изменениях стоит разбить на микрокомпоненты.
