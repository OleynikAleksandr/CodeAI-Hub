# План развития проекта (Development TODO Plan)

## Легенда
- TODO — задача запланирована
- IN_PROGRESS — работа в процессе
- BLOCKED — требуется внешнее действие
- DONE — задача выполнена

## Phase 10 — Инфраструктура Core Orchestrator (владелец: Codex, обновлено: 2025-10-24)
**Цель:** Подготовить физическую структуру для разработки автономного ядра

- [DONE] Создать структуру директорий packages/core/ с поддиректориями src/
- [DONE] Настроить packages/core/package.json с зависимостями (express, ws, pkg и т.д.)
- [DONE] Настроить packages/core/tsconfig.json и интегрировать в npm workspaces
- [DONE] Создать scripts/build-core.sh (аналог build-cef-launcher.sh) для компиляции pkg
- [DONE] Создать assets/core/manifest.json для версионирования и распространения
- [DONE] Добавить модуль установщика ядра в src/extension-module/core/ (аналог cef/runtime-installer.ts)
- [DONE] Протестировать локальный цикл сборки: npm run build:core → бинарники в doc/tmp/releases/

**Коммит:** 2dbb8c2 - feat: Phase 10 - core orchestrator infrastructure

---

## Phase 10А — Спецификация функций автономного ядра (владелец: Codex, обновлено: 2025-10-25)
**Цель:** Детально описать функциональность и API ядра перед проектированием архитектуры

- [DONE] Создать документ CoreOrchestrator_Specification.md (v0.1.9)
- [DONE] Обсудить User Journeys (5 сценариев)
- [DONE] Согласовать стратегию инкрементальных обновлений (2.3.1, 2.3.2)
- [DONE] Закрыть все архитектурные вопросы (Q1-Q7):
  - JSONL для персистентности
  - pkg + tar.bz2 для упаковки ядра
  - НЕТ мультипользовательского режима
  - НЕТ публичных API плагинов
  - Провайдеры как отдельные модули
  - Лимиты настраиваемые через UI
  - НЕТ кэширования ответов
- [DONE] Переработать Roadmap под быстрое получение работающего результата
- [DONE] Зафиксировать функциональные требования (F-01 до F-40)
- [DONE] Определить API спецификацию (HTTP + WebSocket)
- [DONE] Описать архитектурные компоненты (8 модулей)

**Коммит:** (будет записан после завершения фазы)

---

## Phase 11 — MVP Каркас (работающая система) (владелец: Codex, обновлено: 2025-10-25)
**Цель:** Минимальный работающий каркас ядра с визуальной проверкой через оба UI

**Реализация ядра:**
- [TODO] Точка входа ядра (packages/core/src/index.ts) с HTTP/WebSocket сервером
- [TODO] Базовый HTTP API (GET /health, GET /status)
- [TODO] WebSocket hub с broadcast для всех клиентов
- [TODO] Mock Session Manager (заглушки сессий)
- [TODO] Mock Provider Registry (список fake-провайдеров: Claude, Codex, Gemini)

**Сборка и распространение ядра:**
- [TODO] Настроить pkg для компиляции бинарников (darwin-arm64, darwin-x64, win32-x64, linux-x64)
- [TODO] Создать script сборки (scripts/build-core.sh)
- [TODO] Упаковать бинарники в tar.bz2 архивы
- [TODO] Создать/обновить assets/core/manifest.json с версиями и SHA-1
- [TODO] Опубликовать в GitHub Releases (или локально в doc/tmp/releases/)

**Интеграция с расширением:**
- [TODO] Обновить установщик ядра в расширении (src/extension-module/core/installer.ts)
- [TODO] Подключение VS Code webview к ядру через WebSocket
- [TODO] Подключение CEF-клиента к ядру через WebSocket

**Mock-функциональность:**
- [TODO] Создание mock-сессии через WebSocket
- [TODO] Отправка сообщения → получение fake-ответа
- [TODO] Синхронизация событий между обоими UI (broadcast)

**Сборка и тестирование VSIX:**
- [TODO] Обновить версию в package.json (например, 1.1.0)
- [TODO] Собрать VSIX через scripts/build-release.sh
- [TODO] Протестировать установку VSIX в чистый VS Code
- [TODO] Проверить автоматическое скачивание и установку ядра

**Визуальная проверка полного цикла:**
- [TODO] Установить VSIX → ядро скачивается и устанавливается в ~/.codeai-hub/core/
- [TODO] Запуск VS Code → ядро стартует автоматически
- [TODO] Открыть webview → список mock-сессий отображается
- [TODO] Создать новую сессию → она появляется в обоих UI
- [TODO] Запустить CEF-клиент → видит те же сессии
- [TODO] Отправить сообщение в webview → оно появляется в CEF
- [TODO] Закрыть VS Code → ядро продолжает работать, CEF работает
- [TODO] Перезапустить VS Code → сессии восстановлены

**Коммит:** (будет записан после завершения фазы)

---

## Phase 12 — Полноценная реализация модулей (владелец: Codex, обновлено: 2025-10-25)
**Цель:** Заменить заглушки на реальные модули с персистентностью

- [TODO] Реализация Session Manager с JSONL персистентностью
- [TODO] Реализация Provider Registry с динамической загрузкой модулей
- [TODO] Реализация Config Manager (чтение ~/.codeai-hub/core/config.json)
- [TODO] Реализация Logger с ротацией логов
- [TODO] Поддержка graceful shutdown и автовосстановления сессий
- [TODO] Механизм обновлений компонентов (installed-versions.json)
- [TODO] Settings UI для настройки лимитов (maxConcurrent, maxClients)

**Коммит:** (будет записан после завершения фазы)

---

## Phase 13 — Интеграция с реальными провайдерами (владелец: Codex, обновлено: 2025-10-25)
**Цель:** Подключить реальные AI провайдеры

- [TODO] Provider Event Adapter для унификации событий
- [TODO] Модуль интеграции с Claude (claude-code CLI + @anthropic-ai/claude-agent-sdk)
- [TODO] Модуль интеграции с Codex (OpenAI SDK)
- [TODO] Модуль интеграции с Gemini (Google AI SDK)
- [TODO] Автоустановка CLI/SDK провайдеров при первом запуске
- [TODO] Авторизация провайдеров через Settings UI

**Коммит:** (будет записан после завершения фазы)

---

## Phase 14 — Тестирование, оптимизация, релиз (владелец: Codex, обновлено: 2025-10-25)
**Цель:** Полное тестирование и подготовка к релизу v1.1.0

- [TODO] E2E тесты полного цикла с реальными провайдерами
- [TODO] Performance тесты (10 сессий, 5 клиентов, 24h работа)
- [TODO] Memory leak detection
- [TODO] Сценарии обновления (VSIX, Core, Launcher)
- [TODO] Откаты при ошибках
- [TODO] Финальная документация
- [TODO] Релиз v1.1.0 с автономным ядром

**Коммит:** (будет записан после завершения фазы)

---

## Backlog / Отложенные задачи
- [TODO] Определить стратегию упаковки провайдерных модулей (версионирование, распространение, изоляция) — будет детализировано в Phase 13
- [TODO] Удалённый доступ: HTTPS, JWT авторизация, TOTP — перспективная функция, не для MVP
- [TODO] Workflow Layer для визардов и multi-agent сценариев — будет добавлено после стабилизации ядра
